# Mobile Scanner Workflow

## New UX Flow with Bottom Drawer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         QR Scanner Screen           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚    [Camera View Active]     â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚    â”‚   QR SCAN AREA  â”‚      â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  Instructions: Scan Batch   â”‚   â”‚
â”‚  â”‚       QR Code First         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

            â¬‡ï¸  User scans batch QR

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         QR Scanner Screen           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚    [Camera Still Active]    â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚    â”‚   QR SCAN AREA  â”‚      â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  âœ“ Session Active           â”‚   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—     â”‚ â¬…ï¸ Drawer @ 50%
â”‚  â•‘  ğŸ“š DAT101 - Data Analysis â•‘     â”‚
â”‚  â•‘  ğŸ“ Exam Hall A            â•‘     â”‚
â”‚  â•‘  Batch: B2024-DAT101-001   â•‘     â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£     â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘     â”‚
â”‚  â•‘  â”‚ 5/20â”‚  3  â”‚   2     â”‚  â•‘     â”‚
â”‚  â•‘  â”‚Present Subm  InProg â”‚  â•‘     â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘     â”‚
â”‚  â•‘  Attendance: 25%          â•‘     â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£     â”‚
â”‚  â•‘  Recent Attendees:        â•‘     â”‚
â”‚  â•‘  â€¢ John Doe (2023001)     â•‘     â”‚
â”‚  â•‘    â° 09:15 âœ… Submitted   â•‘     â”‚
â”‚  â•‘  â€¢ Jane Smith (2023002)   â•‘     â”‚
â”‚  â•‘    â° 09:18 ğŸ”µ Present     â•‘     â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

       â¬‡ï¸  User continues scanning student IDs

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         QR Scanner Screen           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    [Camera Still Active]    â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚    â”‚   QR SCAN AREA  â”‚      â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚  âœ“ Scanned Successfully     â”‚   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—     â”‚
â”‚  â•‘  ğŸ“š DAT101 - Data Analysis â•‘     â”‚
â”‚  â•‘  ğŸ“ Exam Hall A            â•‘     â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£     â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘     â”‚
â”‚  â•‘  â”‚ 6/20â”‚  3  â”‚   3     â”‚  â•‘  â¬…ï¸ Auto-updated!
â”‚  â•‘  â”‚Present Subm  InProg â”‚  â•‘     â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘     â”‚
â”‚  â•‘  Attendance: 30%          â•‘     â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£     â”‚
â”‚  â•‘  Recent Attendees:        â•‘     â”‚
â”‚  â•‘  â€¢ Alice Wong (2023003)   â•‘  â¬…ï¸ New!
â”‚  â•‘    â° 09:22 ğŸ”µ Present     â•‘     â”‚
â”‚  â•‘  â€¢ John Doe (2023001)     â•‘     â”‚
â”‚  â•‘    â° 09:15 âœ… Submitted   â•‘     â”‚
â”‚  â•‘  â€¢ Jane Smith (2023002)   â•‘     â”‚
â”‚  â•‘    â° 09:18 ğŸ”µ Present     â•‘     â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

       â¬†ï¸  Swipe up to expand drawer

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—     â”‚
â”‚  â•‘  ğŸ“š DAT101 - Data Analysis â•‘     â”‚ â¬…ï¸ Drawer @ 90%
â”‚  â•‘  ğŸ“ Exam Hall A            â•‘     â”‚
â”‚  â•‘  Batch: B2024-DAT101-001   â•‘     â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£     â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘     â”‚
â”‚  â•‘  â”‚ 6/20â”‚  3  â”‚   3     â”‚  â•‘     â”‚
â”‚  â•‘  â”‚Present Subm  InProg â”‚  â•‘     â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘     â”‚
â”‚  â•‘  Attendance: 30%          â•‘     â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£     â”‚
â”‚  â•‘  Recent Attendees (6):    â•‘     â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘     â”‚
â”‚  â•‘  â”‚ â€¢ Alice Wong          â”‚â•‘     â”‚
â”‚  â•‘  â”‚   2023003             â”‚â•‘     â”‚
â”‚  â•‘  â”‚   â° 09:22 ğŸ”µ Present  â”‚â•‘     â”‚
â”‚  â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â•‘     â”‚
â”‚  â•‘  â”‚ â€¢ John Doe            â”‚â•‘     â”‚
â”‚  â•‘  â”‚   2023001             â”‚â•‘     â”‚
â”‚  â•‘  â”‚   â° 09:15 âœ… Submittedâ”‚â•‘     â”‚
â”‚  â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â•‘     â”‚
â”‚  â•‘  â”‚ [More students...]    â”‚â•‘     â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘     â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£     â”‚
â”‚  â•‘  [View Full Details â†’]    â•‘     â”‚
â”‚  â•‘  [End Session]            â•‘     â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Benefits

### 1. **Camera Always Visible**

- Invigilator can continuously scan without navigation
- No context switching between screens
- Faster workflow during busy exam entry period

### 2. **Real-time Feedback**

- Stats update immediately after each scan
- Visual confirmation with updated count
- No need to refresh or navigate away

### 3. **Flexible Information Display**

- 25% snap: Minimal info while focusing on camera
- 50% snap: Balanced view with recent attendees
- 90% snap: Full list when needed

### 4. **Quick Actions**

- Pull to refresh attendance data
- Swipe down to minimize
- Tap "View Full Details" for complete data
- Tap "End Session" to clear and start fresh

### 5. **Progressive Disclosure**

- Start with essential info (course, batch, stats)
- Expand to see more details when needed
- Full page available via button if deep analysis required

## Comparison: Old vs New

### Old Flow

```
1. Scan batch QR â†’ Navigate to Batch Details page
2. Page loads with all data
3. Back button â†’ Return to scanner
4. Scan student â†’ Navigate to Student Attendance page
5. Confirm â†’ Navigate back to scanner
6. Repeat...
```

**Problems**: Too much navigation, context loss, camera inactive

### New Flow

```
1. Scan batch QR â†’ Drawer slides up (camera stays on)
2. See minimal info + stats
3. Scan student â†’ Drawer updates (camera stays on)
4. Continue scanning (drawer updates in real-time)
5. Swipe drawer to adjust view as needed
```

**Benefits**: Minimal navigation, camera always active, real-time updates

## Mobile Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Scanner Screen (Tab)         â”‚
â”‚  - Manages camera permission        â”‚
â”‚  - Handles QR code scanning         â”‚
â”‚  - Maintains activeExamSession stateâ”‚
â”‚  - Controls bottomSheetRef          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ Uses
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      AttendanceDrawer Component     â”‚
â”‚  - Receives session via props       â”‚
â”‚  - Polls API every 10s              â”‚
â”‚  - Renders stats & attendance list  â”‚
â”‚  - Provides "View Details" button   â”‚
â”‚  - Provides "End Session" button    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ Fetches from
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     examSessionsApi.getExamSession  â”‚
â”‚  Returns:                           â”‚
â”‚  - Session details                  â”‚
â”‚  - stats object                     â”‚
â”‚  - attendances array                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## State Management

### Scanner Screen State

```typescript
const [activeExamSession, setActiveExamSession] = useState<ExamSession | null>(
  null
);
const bottomSheetRef = useRef<BottomSheet>(null);
```

### Drawer Component State

```typescript
const [attendances, setAttendances] = useState<ExamAttendance[]>([]);
const [stats, setStats] = useState<any>(null);
const [loading, setLoading] = useState(false);
```

### Real-time Updates

```typescript
useEffect(() => {
  if (session) {
    loadAttendanceData();
    const interval = setInterval(loadAttendanceData, 10000);
    return () => clearInterval(interval);
  }
}, [session, loadAttendanceData]);
```

## Gesture Handling

- **Swipe Up**: Expand drawer to next snap point
- **Swipe Down**: Minimize drawer to previous snap point
- **Pan Down from Top**: Close drawer (disabled by default)
- **Tap Outside**: No action (drawer stays open)
- **Pull-to-Refresh**: Refresh attendance data

## Error Handling

### Scenarios Handled

1. **No Active Session**: Alert user to scan batch QR first
2. **API Failure**: Display error message with retry button
3. **Empty Attendance**: Show "No students scanned yet" message
4. **Network Timeout**: Auto-retry with exponential backoff

### User Feedback

- Loading spinner during data fetch
- Success message after scan
- Error alerts with clear instructions
- Status badges with color coding
